<!DOCTYPE html>
<html>
<head>
<title>NovaStudio — Game Creator</title>
<style>
/* -------- GENERAL EDITOR LAYOUT -------- */
body {
  margin: 0;
  overflow: hidden;
  background: #1a1a1a;
  color: #ddd;
  font-family: Arial;
}

#topbar {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 40px;
  background: #2c2c2c;
  display: flex;
  align-items: center;
  padding: 5px 10px;
  z-index: 10;
}

#topbar button {
  margin-right: 10px;
  padding: 6px 12px;
  background: #444;
  border: none;
  color: white;
  border-radius: 4px;
}

#sidebar-left {
  position: fixed;
  top: 40px; left: 0;
  width: 260px; bottom: 0;
  background: #202020;
  border-right: 2px solid #111;
  overflow-y: auto;
}

#sidebar-right {
  position: fixed;
  top: 40px; right: 0;
  width: 260px; bottom: 0;
  background: #202020;
  border-left: 2px solid #111;
  overflow-y: auto;
}

#viewport {
  position: fixed;
  top: 40px; left: 260px;
  right: 260px; bottom: 0;
  background: black;
}

/* -------- PANELS -------- */

.panel-title {
  font-weight: bold;
  margin: 10px;
  font-size: 16px;
}

.panel-section {
  padding: 10px;
  border-bottom: 1px solid #333;
}

input, select {
  width: 100%;
  padding: 6px;
  background: #333;
  border: 1px solid #555;
  color: white;
  margin-top: 5px;
}
</style>
</head>

<body>

<!-- TOPBAR -->
<div id="topbar">
  <button onclick="addObject('cube')">Add Cube</button>
  <button onclick="addObject('sphere')">Add Sphere</button>
  <button onclick="addTerrain()">Add Terrain</button>
  <button onclick="playMultiplayer()">Play Multiplayer</button>
  <button onclick="openScriptEditor()">Scripts</button>
</div>

<!-- HIERARCHY (LEFT) -->
<div id="sidebar-left">
  <div class="panel-title">Workspace</div>
  <div id="hierarchy" class="panel-section"></div>

  <div class="panel-title">Assets</div>
  <div class="panel-section">
    <button onclick="addObject('npc')">NPC</button>
    <button onclick="addObject('light')">Light</button>
  </div>
</div>

<!-- PROPERTIES (RIGHT) -->
<div id="sidebar-right">
  <div class="panel-title">Properties</div>
  <div id="properties" class="panel-section">
    Select an object.
  </div>
</div>

<!-- VIEWPORT -->
<div id="viewport"></div>

<!-- External Libraries -->
<script src="https://cdn.jsdelivr.net/npm/three@0.159/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.159/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.159/examples/js/controls/TransformControls.js"></script>

<script>
// =====================================================
//      NOVASTUDIO — CUSTOM GAME ENGINE CORE
// =====================================================
let scene, camera, renderer, orbit, transform;
let selected = null;

function init() {
  scene = new THREE.Scene();
  scene.background = new THREE.Color(0x262626);

  camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 500);
  camera.position.set(8,8,8);

  renderer = new THREE.WebGLRenderer({ antialias:true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  document.getElementById("viewport").appendChild(renderer.domElement);

  orbit = new THREE.OrbitControls(camera, renderer.domElement);
  transform = new THREE.TransformControls(camera, renderer.domElement);
  transform.addEventListener("dragging-changed", e => orbit.enabled = !e.value);
  scene.add(transform);

  let light = new THREE.DirectionalLight(0xffffff, 1);
  light.position.set(10,10,10);
  scene.add(light);

  animate();
}

function animate() {
  requestAnimationFrame(animate);
  renderer.render(scene, camera);
}

// -------- OBJECT CREATION --------
let idCounter = 0;

function addObject(type) {
  let mesh;

  if (type === 'cube') mesh = new THREE.Mesh(new THREE.BoxGeometry(1,1,1), new THREE.MeshStandardMaterial({ color:0x00aaff }));
  if (type === 'sphere') mesh = new THREE.Mesh(new THREE.SphereGeometry(0.6,32,32), new THREE.MeshStandardMaterial({ color:0xff6666 }));
  if (type === 'light') mesh = new THREE.PointLight(0xffffff,1,20);
  if (type === 'npc') mesh = new THREE.Mesh(new THREE.BoxGeometry(1,2,1), new THREE.MeshStandardMaterial({ color:0x33ff33 }));

  mesh.position.set(0,1,0);
  mesh.userData.id = "obj" + (idCounter++);
  mesh.userData.type = type;

  scene.add(mesh);
  refreshHierarchy();
}

// -------- HIERARCHY PANEL --------
function refreshHierarchy() {
  let list = "";

  scene.children.forEach(obj => {
    if (obj.userData.id)
      list += `<div onclick="selectObject('${obj.userData.id}')">${obj.userData.id} (${obj.userData.type})</div>`;
  });

  document.getElementById("hierarchy").innerHTML = list;
}

// -------- SELECTING OBJECTS --------
function selectObject(id) {
  selected = scene.children.find(o => o.userData.id === id);
  transform.attach(selected);
  updatePropertiesPanel();
}

// -------- PROPERTIES PANEL --------
function updatePropertiesPanel() {
  if (!selected) return;

  document.getElementById("properties").innerHTML = `
    <label>Position X</label>
    <input type="number" value="${selected.position.x}" onchange="selected.position.x=parseFloat(this.value)">
    <label>Position Y</label>
    <input type="number" value="${selected.position.y}" onchange="selected.position.y=parseFloat(this.value)">
    <label>Position Z</label>
    <input type="number" value="${selected.position.z}" onchange="selected.position.z=parseFloat(this.value)">
  `;
}

// -------- TERRAIN --------
function addTerrain() {
  let geo = new THREE.PlaneGeometry(40,40, 20,20);
  let mat = new THREE.MeshStandardMaterial({ color:0x228833, wireframe:false });
  let terr = new THREE.Mesh(geo,mat);
  terr.rotation.x = -Math.PI/2;
  terr.userData.id = "terrain";
  terr.userData.type = "terrain";

  scene.add(terr);
  refreshHierarchy();
}

// -------- MULTIPLAYER TEST (SHELL ONLY) --------
function playMultiplayer() {
  alert("Multiplayer Test Mode coming soon!");
}

// -------- SCRIPT EDITOR (SHELL ONLY) --------
function openScriptEditor() {
  alert("Script editor coming soon!");
}

init();
</script>

</body>
</html>
